<!DOCTYPE html>
<html lang="tr">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harita Uygulaması</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <style>
        /* Tam ekran intro katmanı */
        #intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            z-index: 10000;
            overflow: hidden;
            transition: all 1s ease-in-out;
        }

        #intro-overlay.hide {
            opacity: 0;
            pointer-events: none;
        }

        .leaflet-control-container {
            z-index: 1 !important;
            /* overlay’in altında kalsın */
        }

        /* Intro animasyon stilleri */
        #year {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(1);
            z-index: 2;
            text-align: center;
            font-size: clamp(2rem, 10vw, 6rem);
            font-weight: bold;
            white-space: nowrap;
            color: white;
            transition: transform 0.1s linear, font-size 0.1s linear;
        }

        .bg {
            position: fixed;
            filter: brightness(0.5);
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 1;
            transition: opacity 2s ease-in-out;
            z-index: 1;
        }

        .bg.show {
            opacity: 1;
        }

        /* Slider kapsayıcısı */
        .slider-container {
            position: relative;
            width: 100%;
            height: 500px;
            overflow: hidden;
            z-index: 1;
            margin-top: 13vh;
        }

        /* Slider stilleri */
        .slider {
            width: 100%;
            height: 100%;
            position: relative;
            perspective: 1000px;
            max-height: 100%;
            max-width: 100%;
            will-change: transform;
        }

        .slider:not(.zoom) .item {
            transition: all 900ms ease-in-out, opacity 400ms linear 0ms;
            opacity: 0;
        }

        .slider:not(.zoom) .item.active {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            opacity: 1;
            pointer-events: all;
        }

        .slider:not(.zoom) .item.active span {
            top: 0;
            transform: scale(1);
        }

        .slider:not(.zoom) .item.active .btn {
            transform: scale(1);
            height: 44px;
        }




        .slider.zoom .item {
            transition: all 900ms ease-in-out, opacity 300ms linear 500ms;
            opacity: 0.5;
        }

        .wrapper {
            height: 100%;
            width: 100%;
            position: absolute;
            transform-style: preserve-3d;
            transition: transform 900ms ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            will-change: transform;
        }

        .item {
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            width: 39%;
            height: 50%;
            color: #fff;
            background-repeat: no-repeat;
            background-size: cover !important;
            background-position: center;
            transition: all 900ms ease-in-out;
            transform-origin: center;
            pointer-events: none;
            will-change: transform;
        }


        .item__info {
            text-align: center;
            text-transform: uppercase;
            font-weight: bold;
            will-change: transform;
        }

        .item__year {
            font-size: 30px;
            letter-spacing: 3px;
            margin-bottom: 35px;
            overflow: hidden;
            line-height: 30px;
            will-change: transform;
        }

        .item__year span {
            position: relative;
            top: 27px;
            transition: all 900ms linear;
            display: inline-block;
            transform: scale(0.7);
            white-space: nowrap;
            will-change: transform;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .item__name {
            font-size: 55px;
            letter-spacing: 3px;
            margin-bottom: 62px;
            overflow: hidden;
            line-height: 55px;
            will-change: transform;
        }

        .item__name span {
            position: relative;
            top: 48px;
            transition: all 900ms ease-in-out;
            display: inline-block;
            transform: scale(0.7);
            white-space: nowrap;
            will-change: transform;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .btn {
            background: #fff;
            color: #120d0b;
            padding: 0 33px;
            text-decoration: none;
            display: inline-block;
            transform: scale(0.7);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
            transition: all 400ms ease-in-out;
            will-change: transform;
            align-content: center;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .arrow {
            background: rgba(142, 32, 55, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            position: absolute;
            top: 50%;
            z-index: 1;
            transform: translateY(-50%);
            cursor: pointer;
            border-radius: 50%;
            width: 70px;
            height: 70px;
            transition: all 0.1s ease-in-out, backdrop-filter 0.3s ease-in-out, background 0.3s ease-in-out;
            transform-origin: 50% 50%;
            will-change: transform, backdrop-filter, background;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .arrow:hover {
            transform: translateY(-50%) scale(1.1);
            background: rgba(142, 32, 55, 0.5);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }

        .arrow.arrow-next {
            right: 1em;
            background: url('https://alikinvv.github.io/3d-carousel/build/img/arrow-right.svg') no-repeat center rgb(255 0 53 / 30%);
            background-size: 38px;
        }

        .arrow.arrow-prev {
            left: 1em;
            background: url('https://alikinvv.github.io/3d-carousel/build/img/arrow-left.svg') no-repeat center rgb(255 0 53 / 30%);
            background-size: 38px;
        }

        @media (min-width: 1400px) {
            .slider-container {
                max-height: 700px;
            }
        }

        /* Harita için yükseklik tanımla */
        #map {
            height: 400px;
        }

        /* Bölümler arasında boşluk ekle */
        .row {
            margin-bottom: 20px;
            margin-left: 0 !important;
            margin-right: 0 !important;
        }

        /* GitHub köşesi için animasyon (kullanılmıyorsa kaldırılabilir) */
        @keyframes octocat-wave {

            0%,
            100% {
                transform: rotate(0);
            }

            20%,
            60% {
                transform: rotate(-25deg);
            }

            40%,
            80% {
                transform: rotate(10deg);
            }
        }

        @media (max-width: 500px) {
            .github-corner:hover .octo-arm {
                animation: none;
            }

            .github-corner .octo-arm {
                animation: octocat-wave 560ms ease-in-out;
            }

            .item__name {
                font-size: 30px;
                line-height: 30px;
            }

            .item__year {
                font-size: 20px;
                line-height: 20px;
            }

            .arrow {
                width: 50px;
                height: 50px;
                background-size: 24px !important;
            }
        }

        /* index.html içeriği başlangıçta gizli */
        .container,
        #header-container {
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .container.show,
        #header-container.show {
            opacity: 1;
        }

        /* NAVBAR */
        .top-nav {
            display: flex;
            gap: 2rem;
            position: relative;
            margin-bottom: 1.5rem;
        }

        .nav-btn {
            text-decoration: none;
            font-weight: bold;
            color: #333;
            padding: 0.5rem 1rem;
            transition: text-shadow 0.25s ease;
        }

        .nav-btn:hover {
            text-shadow: 0 0 0.1em #333;
        }

        .nav-btn.active {
            color: #000;
        }

        .nav-indicator {
            height: 3px;
            border-radius: 2px;
            position: absolute;
            bottom: -5px;
            background-color: #000;
            transition: all 0.3s ease-in-out;
            pointer-events: none;
        }

        .grave-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #ddd;
            cursor: pointer;
        }

        .grave-item:hover {
            background-color: #f8f9fa;
        }

        .grave-image {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
        }

        #graves-map {
            height: 400px;
        }








       .container-workers {
    display: flex;
    min-height: 100vh;
    flex-direction: row;
}

/* Sol panel */
.sidebar {
    width: 25%;
    padding: 20px;
    border-right: 1px solid #ddd;
    background: #f9f9f9;
}

.sidebar input[type="text"] {
    width: 100%;
    padding: 10px;
    margin-bottom: 20px;
    border-radius: 5px;
    border: 1px solid #ccc;
    font-size: 16px;
}

.filter-item {
    padding: 8px 24px;
    cursor: pointer;
    position: relative;
    transition: background 0.3s;
    margin-bottom: 8px;
    border-radius: 5px;
    font-size: 14px;
}

.filter-item:hover {
    background: #eee;
}

.filter-item.active {
    background: #dff0d8;
}

.filter-item.active::before {
    content: "✔";
    position: absolute;
    left: 8px;
    color: green;
    font-weight: bold;
}

/* Sağ panel */
.content {
    width: 75%;
    padding: 20px;
}

.content input[type="text"] {
    width: 100%;
    padding: 10px;
    margin-bottom: 20px;
    border-radius: 5px;
    border: 1px solid #ccc;
    font-size: 16px;
}

.grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
    position: relative;
}

/* Worker kartları */
.worker-wrapper {
    background: #fff;
    border-radius: 20px;
    box-shadow: 0 2px 5px 2px rgba(0, 0, 0, 0.2);
    font-size: 0;
    opacity: 1;
    transition: opacity 0.3s ease;
    position: relative;
    overflow: hidden;
}

.worker-wrapper.fade-out {
    opacity: 0;
    pointer-events: none;
    position: absolute;
}

.worker-wrapper.fade-in {
    opacity: 1;
    pointer-events: auto;
    position: relative;
}

.worker-banner canvas {
    display: block;
    width: 100%;
    height: 180px;
    background-position: center center;
    background-size: cover;
    border-radius: 20px 20px 0 0;
}

.worker-details {
    display: block;
    padding: 80px 20px 20px;
    position: relative;
}

.worker-dp {
    border-radius: 50%;
    width: 120px;
    height: 120px;
    margin: 0 auto;
    position: absolute;
    top: -60px;
    left: 0;
    right: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: transform 0.3s ease-in;
}

.worker-dp canvas {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 2px solid #000;
    background-position: center;
    background-size: cover;
}

.worker-name {
    text-align: center;
    z-index: 5;
    position: relative;
    margin-top: 0.5vh;
}

.worker-name h2 {
    font-size: 18px;
    line-height: 1.2;
    color: #2d303a;
    margin: 0;
}

.worker-name h2 span {
    display: block;
    font-size: 12px;
    margin-top: 1vh;
    margin-bottom: 2vh;
    color: #666;
    font-weight: 400;
}

.worker-bio {
    max-height: 10vh;
    overflow: hidden;
}

.worker-bio p {
    font-size: 13px;
    line-height: 18px;
    color: #666;
    text-align: left;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
}

.worker-button {
    display: block;
    text-align: center;
    margin: 20px 0;
}

.worker-button a {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 180px;
    height: 40px;
    background: #e8c411;
    color: #000;
    margin: 0 auto;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 600;
    text-decoration: none;
    transition: 0.3s all ease-in;
}

.worker-dp:hover {
    transform: scale(1.1);
}

.worker-button a:hover {
    transform: scale(1.05);
    background: #fbfb00;
}

/* Tablet ve küçük ekranlar için */
@media (max-width: 768px) {
    .container-workers {
        flex-direction: column;
        height: auto;
    }

    .sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #ddd;
        padding: 15px;
    }

    .sidebar input[type="text"] {
        padding: 8px;
        font-size: 14px;
    }

    .filter-item {
        padding: 6px 20px;
        font-size: 13px;
        margin-bottom: 6px;
    }

    .content {
        width: 100%;
        padding: 15px;
    }

    .content input[type="text"] {
        padding: 8px;
        font-size: 14px;
    }

    .grid {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: 15px;
    }

    .worker-banner canvas {
        height: 140px;
    }

    .worker-details {
        padding: 70px 15px 15px;
    }

    .worker-dp {
        width: 100px;
        height: 100px;
        top: -50px;
    }

    .worker-name h2 {
        font-size: 16px;
    }

    .worker-name h2 span {
        font-size: 11px;
    }

    .worker-bio p {
        font-size: 12px;
        line-height: 16px;
    }

    .worker-button a {
        width: 160px;
        height: 35px;
        font-size: 13px;
    }
}

/* Çok küçük ekranlar için (ör. telefonlar) */
@media (max-width: 480px) {
    .container-workers {
        flex-direction: column;
        height: auto;
    }

    .sidebar {
        padding: 10px;
    }

    .sidebar input[type="text"] {
        padding: 6px;
        font-size: 13px;
    }

    .filter-item {
        padding: 5px 15px;
        font-size: 12px;
        margin-bottom: 5px;
    }

    .content {
        padding: 10px;
    }

    .content input[type="text"] {
        padding: 6px;
        font-size: 13px;
    }

    .grid {
        grid-template-columns: 1fr;
        gap: 10px;
    }

    .worker-wrapper {
        border-radius: 15px;
    }

    .worker-banner canvas {
        height: 120px;
        border-radius: 15px 15px 0 0;
    }

    .worker-details {
        padding: 60px 10px 10px;
    }

    .worker-dp {
        width: 80px;
        height: 80px;
        top: -40px;
    }

    .worker-name h2 {
        font-size: 14px;
    }

    .worker-name h2 span {
        font-size: 10px;
        margin-bottom: 1.5vh;
    }

    .worker-bio p {
        font-size: 11px;
        line-height: 15px;
    }

    .worker-button a {
        width: 140px;
        height: 32px;
        font-size: 12px;
        border-radius: 15px;
    }
}
        /* FADE + ZOOM SLIDER İÇİN GÜNCELLEMELER */

/* Slider kapsayıcısına 3D perspektif ekle */
.slider-container {
    perspective: 1000px;
    perspective-origin: center center;
}

/* Wrapper için 3D koruma */
.wrapper {
    transform-style: preserve-3d;
}

/* Item'lar için fade ve zoom efektleri */
.item {
    /* Mevcut stiller korunuyor */
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    
    /* FADE EFEKTİ */
    opacity: 0;
    visibility: hidden;
    transition: all 900ms ease-in-out;
    transform: scale(0.8) translateZ(0);
    
    /* Mevcut diğer stiller... */
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    background-repeat: no-repeat;
    background-size: cover !important;
    background-position: center;
    pointer-events: none;
    will-change: transform, opacity;
}

/* Aktif item */
.item.active {
    opacity: 1;
    visibility: visible;
    transform: scale(1) translateZ(0);
    pointer-events: all;
    z-index: 10;
}

/* Zoom efekti sırasında */
.slider.zoom .item {
    transition: all 900ms ease-in-out, opacity 300ms linear 500ms;
}

.slider.zoom .item:not(.active) {
    opacity: 0.3;
    transform: scale(0.9);
}

.slider.zoom .item.active {
    opacity: 1;
    transform: scale(1.1);
    z-index: 20;
}

/* Item info için düzeltme */
.item__info {
    /* Mevcut stiller korunuyor */
    text-align: center;
    text-transform: uppercase;
    font-weight: bold;
    will-change: transform;
    
    /* Fade sırasında sabit kalması için */
    position: relative;
    z-index: 5;
}

/* Span animasyonları - mevcut CSS korunuyor */
.item__year span,
.item__name span {
    /* Mevcut animasyonlar korunuyor */
    transition: all 900ms ease-in-out;
    transform: scale(0.7);
}

.item.active .item__year span,
.item.active .item__name span {
    transform: scale(1);
}

/* Button animasyonu */
.btn {
    /* Mevcut stiller korunuyor */
    transform: scale(0.7);
    transition: all 400ms ease-in-out;
}

.item.active .btn {
    transform: scale(1);
}

/* Oklar için z-index */
.arrow {
    /* Mevcut stiller korunuyor */
    z-index: 100; /* Slider'ın üstünde */
}

/* Responsive */
@media (max-width: 768px) {
    .item__name {
        font-size: 30px;
        line-height: 30px;
    }
    
    .item__year {
        font-size: 20px;
        line-height: 20px;
    }
    
    .slider.zoom .item.active {
        transform: scale(1.05); /* Mobilde daha az zoom */
    }
}
/* DRAGABLE İÇİN GEREKLİ STİLLER */
.slider {
    /* Mevcut stillere ekle */
    touch-action: pan-y; /* Yatay sürükleme için */
    user-select: none; /* Metin seçimi engelle */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

/* Sürükleme sırasında hafif kaydırma efekti */
.slider:active,
.slider.dragging {
    cursor: grabbing !important;
    transition: none !important; /* Anlık tepki için */
}

/* Zoom efekti sırasında cursor */
.slider.zoom {
    cursor: grab;
}

.slider.zoom:active {
    cursor: grabbing;
}

/* Mobilde daha hassas dokunma */
@media (max-width: 768px) {
    .slider {
        touch-action: pan-y pinch-zoom; /* Zoom da çalışsın */
    }
    
    /* Mobilde drag threshold'u küçült */
    /* JavaScript'te dragThreshold = 30; yapabilirsiniz */
}
    </style>


</head>

<body>
    <!-- Intro Animasyon Katmanı -->
    <div id="intro-overlay">
        <div id="year">0</div>
        <div id="bg1" class="bg"></div>
        <div id="bg2" class="bg"></div>
    </div>

    <div id="header-container"></div>
    <!-- Slider Bölümü -->
    <div class="row">
        <div class="col-12" style="padding: 0 !important;">
            <div class="slider-container">
                <div class="slider">
                    <div class="arrow arrow-prev"></div>
                    <div class="wrapper" id="slider-wrapper">
                        <!-- Dinamik olarak doldurulacak -->
                    </div>
                    <div class="arrow arrow-next"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Harita ve Kişi Listesi Bölümü -->
        <!-- NAVBAR -->
        <nav class="top-nav">
            <a href="#" class="nav-btn active" data-target="persons-row">Kişiler</a>
            <a href="#" class="nav-btn" data-target="sell-grave-row">Satılık Mezarlar</a>
            <a href="#" class="nav-btn" data-target="workers-row">Çalışanlar</a>
            <div class="nav-indicator"></div>
        </nav>

    </div>
    <!-- ROWLAR -->
    <div class="row persons-row">
        <div class="col-md-4 person-list">
            <h4>Kişiler</h4>
            <div id="person-list"></div>
            <a href="/grave/add-person.html" class="add-person-btn">Kişi Ekle</a>
        </div>
        <div class="col-md-8">
            <h1>Harita Üzerinde Kişiler</h1>
            <div id="map"></div>
        </div>
    </div>

    <div class="row sell-grave-row" style="display:none;">
        <div class="col-md-4 graves-list">
            <h4>Satılık Mezarlar</h4>
            <div id="graves-list"></div>
        </div>
        <div class="col-md-8">
            <h1>Harita Üzerinde Mezar Konumları</h1>
            <div id="graves-map" style="height: 400px;"></div>
        </div>
    </div>

    <!-- Çalışanlar Sekmesi -->
    <div class="row workers-row" style="display:none;">
        <div class="container-workers">
            <!-- Sol Panel -->
            <div class="sidebar">
                <input type="text" id="sidebarSearch" placeholder="Kategorilerde ara...">
                <div id="filterList"></div>
            </div>
            <!-- Sağ Panel -->
            <div class="content">
                <input type="text" id="contentSearch" placeholder="Kartlarda ara...">
                <div class="grid" id="workerGrid"></div>
            </div>
        </div>
    </div>


    <div class="row">
        <div class="col-md-12">
            <div id="details" class="details"></div>
        </div>
    </div>


    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="/grave/script.js"></script>

    <script>

        document.addEventListener("DOMContentLoaded", async () => {
            // Header'ı yükle (her sayfada bir kez)
            const headerContainer = document.getElementById('header-container');
            if (headerContainer) {
                try {
                    const headerResponse = await fetch('/grave/header.html');
                    if (headerResponse.ok) {
                        headerContainer.innerHTML = await headerResponse.text();
                        console.log('Header yüklendi');
                    } else {
                        console.warn('Header yüklenemedi:', headerResponse.status);
                    }
                } catch (error) {
                    console.error('Header yükleme hatası:', error);
                }
            }

            // Header olaylarını bağla (arama kutusu, ana sayfa, profil)
            const searchInput = document.querySelector('.header-search');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    searchPersons(e.target.value, window.persons || [], window.workers || []);
                });
                searchInput.addEventListener('blur', () => {
                    setTimeout(() => {
                        const searchResults = document.getElementById('search-results');
                        if (searchResults) searchResults.classList.remove('show');
                    }, 200);
                });
            }

            const homeLink = document.querySelector('.header-home');
            if (homeLink) {
                homeLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.href = '/grave/index.html';
                });
            }

            const profileImg = document.querySelector('.header-profile img');
            if (profileImg) {
                profileImg.addEventListener('click', () => {
                    window.location.href = '/grave/profile.html';
                });
            }

            // Sayfa'ya özgü fonksiyonu çağır (header sonrası)
            if (window.location.pathname.includes('profile.html')) {
                loadProfileData();
            } else if (window.location.pathname.includes('worker-profile.html')) {
                loadWorkerProfile();
            } else {
                loadDataAndHeader(); // Veri yükleme, header hariç
            }
        });


        // Intro animasyon verileri
        const currentYear = new Date().getFullYear();
        const yearEl = document.getElementById("year");
        const leaders = [
            { img: "images/img1.png" },
            { img: "images/img2.jpg" },
            { img: "images/img3.jpg" },
            { img: "images/img4.png" },
            { img: "images/img5.jpg" },
            { img: "images/img6.jpg" },
            { img: "images/img7.jpg" },
            { img: "images/img8.jpg" },
            { img: "images/img9.jpg" },
            { img: "images/img10.png" },
            { img: "images/img11.jpg" },
            { img: "images/img12.jpg" },
            { img: "images/img13.jpg" },
            { img: "images/img14.jpg" },
            { img: "images/img15.jpg" },
            { img: "images/img16.jpg" },
            { img: "images/img17.jpg" },
            { img: "images/img18.jpg" },
            { img: "images/img19.jpg" },
            { img: "images/img20.jpg" }
        ];
        const lastImages = [
            { year: currentYear - 2, img: "images/cengiz2.jpg" },
            { year: currentYear - 1, img: "images/Fatih-Sultan-Mehmet-800x315.jpg" },
            { year: currentYear, img: "images/3dduvarkagitlari-1c90ebc2.jpg" }
        ];
        let activeBg = 1;
        const bg1 = document.getElementById("bg1");
        const bg2 = document.getElementById("bg2");
        const introOverlay = document.getElementById("intro-overlay");

        // Preload
        leaders.concat(lastImages).forEach(item => { new Image().src = item.img; });

        function changeBackground(imgUrl) {
            const nextBg = activeBg === 1 ? bg2 : bg1;
            const prevBg = activeBg === 1 ? bg1 : bg2;
            nextBg.style.backgroundImage = `url(${imgUrl})`;
            nextBg.classList.add("show");
            prevBg.classList.remove("show");
            activeBg = activeBg === 1 ? 2 : 1;
        }

        function getRandomLeaderImage() {
            return leaders[Math.floor(Math.random() * leaders.length)].img;
        }

        function animateYears() {
            return new Promise(resolve => {
                const fastEnd = currentYear - 3;
                const fastDuration = 3000;
                const startTime = performance.now();

                function fastAnimate(now) {
                    const progress = (now - startTime) / fastDuration;
                    let year = Math.floor(progress * fastEnd);
                    if (year > fastEnd) year = fastEnd;
                    yearEl.textContent = year;
                    yearEl.style.transform = "translate(-50%, -50%) scale(1)";
                    if (year % 10 === 0 && year !== 0) changeBackground(getRandomLeaderImage());
                    if (year < fastEnd) requestAnimationFrame(fastAnimate);
                    else animateLastYears();
                }

                function animateLastYears() {
                    let startScale = 1;
                    let endScale = 6;
                    let duration = 3000; // 3 saniye boyunca büyüme
                    let startTime = performance.now();

                    function scaleAnimate(now) {
                        let t = (now - startTime) / duration;
                        if (t > 1) t = 1;
                        let scale = startScale + t * (endScale - startScale);
                        yearEl.style.transform = `translate(-50%, -50%) scale(${scale})`;
                        yearEl.style.opacity = 1; // büyürken sabit görünsün

                        let currentIdx = Math.floor(t * lastImages.length);
                        if (currentIdx >= lastImages.length) currentIdx = lastImages.length - 1;
                        yearEl.textContent = lastImages[currentIdx].year;
                        changeBackground(lastImages[currentIdx].img);

                        if (t < 1) {
                            requestAnimationFrame(scaleAnimate);
                        } else {
                            // Son yıl ekranda sabit kalsın 1 saniye
                            setTimeout(() => {
                                // Sonrasında kaybolma animasyonu
                                yearEl.style.transition = "opacity 1s ease";
                                yearEl.style.opacity = 0;

                                // Intro küçülme
                                const sliderContainer = document.querySelector('.slider-container');
                                const rect = sliderContainer.getBoundingClientRect();
                                introOverlay.style.transition = 'all 1s ease-in-out';
                                introOverlay.style.width = `${rect.width}px`;
                                introOverlay.style.height = `${rect.height}px`;
                                introOverlay.style.top = `${rect.top + window.scrollY}px`;
                                introOverlay.style.left = `${rect.left + window.scrollX}px`;
                                introOverlay.style.transform = 'translate(0, 0)';
                                setTimeout(() => {
                                    introOverlay.classList.add('hide');
                                    document.querySelector('.container').classList.add('show');
                                    document.querySelector('#header-container').classList.add('show');
                                    setTimeout(() => introOverlay.remove(), 1000);
                                }, 1000);
                                resolve();
                            }, 1000);
                        }
                    }
                    requestAnimationFrame(scaleAnimate);
                }

                requestAnimationFrame(fastAnimate);
            });
        }

        const allImages = leaders.map(l => l.img).concat(lastImages.map(l => l.img));

        // Eğer animasyon daha önce gösterilmediyse çalıştır
        if (!localStorage.getItem("introPlayed")) {
            // Scroll kapat
            document.body.style.overflow = 'hidden';

            Promise.all(allImages.map(src => new Promise(resolve => {
                const img = new Image();
                img.src = src;
                img.onload = img.onerror = resolve;
            }))).then(() => {
                changeBackground(getRandomLeaderImage());
                animateYears().then(() => {
                    console.log("Intro animasyonu tamamlandı!");
                    localStorage.setItem("introPlayed", "true");

                    // Scroll tekrar aç
                    document.body.style.overflow = '';
                });
            });
        } else {
            introOverlay.style.display = "none";
            document.querySelector('.container').classList.add('show');
            document.querySelector('#header-container').classList.add('show');
        }


        //----------------------------------------------------------------------------------------------------------//
        // Örnek persons dizisi (gerçek verilerinle değiştir)
        const persons = [
            {
                "id": 1,
                "name": "Osman",
                "surname": "Gazi",
                "title": "Osmanlı'nın Kurucusu",
                "profession": "Padişah",
                "birthDeath": "1258-1326",
                "locationLink": "https://maps.google.com/?q=40.123456, 29.123456",
                "profileImage": "images/osman-gazi.jpg",
                "coverImage": "images/osmangazi.png"
            },
            {
                "id": 2,
                "name": "Yavuz Sultan",
                "surname": "Selim",
                "title": "Selîmî",
                "profession": "Padişah",
                "birthDeath": "1470-1520",
                "locationLink": "https://www.google.com/maps?q=41.0082,28.9784",
                "profileImage": "images/ahmet.jpg",
                "coverImage": "images/kapakresim.webp"
            },
            {
                "id": 3,
                "name": "Fatih Sultan",
                "surname": "Mehmet",
                "title": "İstanbul'un Fatihi",
                "profession": "Padişah",
                "birthDeath": "1432-1481",
                "locationLink": "https://maps.google.com/?q=41.016793682313924,28.94845962524414",
                "profileImage": "images/mehmet.png",
                "coverImage": "images/topkapi-sarayi.webp"
            }
        ];

        // Türkçe karakterleri Latin harflerine çeviren ve slug oluşturan fonksiyon
        function createUrlSlug(name, surname) {
            const turkishToLatin = str => str
                .replace(/ç/g, 'c').replace(/ğ/g, 'g').replace(/ı/g, 'i')
                .replace(/ö/g, 'o').replace(/ş/g, 's').replace(/ü/g, 'u')
                .replace(/Ç/g, 'c').replace(/Ğ/g, 'g').replace(/İ/g, 'i')
                .replace(/Ö/g, 'o').replace(/Ş/g, 's').replace(/Ü/g, 'u');
            return `${turkishToLatin(name.toLowerCase())}${turkishToLatin(surname.toLowerCase())}`;
        }

        // persons dizisine slug ekle
        persons.forEach(p => {
            p.urlSlug = createUrlSlug(p.name, p.surname);
        });

      // Slider'ı dinamik olarak doldur
const sliderWrapper = document.getElementById('slider-wrapper');

// Önce item sayısını hesapla
const itemCount = persons.length;
console.log(`🔢 Toplam item: ${itemCount}`);

// Her item için wrapper oluştur
persons.forEach((person, index) => {
    const item = document.createElement('div');
    item.className = `item ${index === 0 ? 'active' : ''}`;
    item.style.backgroundImage = `url('${person.coverImage || 'https://via.placeholder.com/800x600'}')`;
    
    item.innerHTML = `
        <div class="item__info">
            <p class="item__year"><span>${person.birthDeath || 'Bilinmiyor'}</span></p>
            <p class="item__name"><span>${person.name} ${person.surname}</span></p>
            <a href="/grave/profile.html?${person.urlSlug}" class="btn"><span>Profile Git</span></a>
        </div>
    `;
    sliderWrapper.appendChild(item);
    
    console.log(`Item ${index + 1} eklendi: ${person.name} ${person.surname}`);
});

// === FADE + ZOOM SLIDER KONTROLLERİ ===
let slider = document.querySelector('.slider');
let wrapper = document.querySelector('.wrapper');
let next = document.querySelector('.arrow-next');
let prev = document.querySelector('.arrow-prev');

// DOM'dan items'ı al
let items = document.querySelectorAll('.item');
let currentIndex = 0; // Mevcut aktif index
let isAnimating = false;
let autoPlayInterval;

// DRAGABLE İÇİN DEĞİŞKENLER
let startX = 0;
let endX = 0;
let isDragging = false;
let dragThreshold = 50; // Minimum sürükleme mesafesi (px)

// Otomatik oynatma - 5 SANİYEDE BİR
function startAutoPlay() {
    clearInterval(autoPlayInterval);
    autoPlayInterval = setInterval(() => {
        if (!isAnimating && !isDragging) {
            nextItem();
        }
    }, 5000); // 5 saniye
}

startAutoPlay();

// SONRAKİ SLIDE (Next)
function nextItem() {
    if (isAnimating || isDragging) return;
    
    console.log(`➡️ Next: Item ${currentIndex + 1} → Item ${currentIndex + 2}`);
    
    isAnimating = true;
    slider.classList.add('zoom'); // Zoom efekti
    
    // Mevcut item'ı gizle
    items[currentIndex].classList.remove('active');
    
    // Sonraki item'ı aktif yap
    currentIndex = (currentIndex + 1) % itemCount;
    items[currentIndex].classList.add('active');
    
    // Animasyon bitince temizle
    setTimeout(() => {
        slider.classList.remove('zoom');
        isAnimating = false;
        startAutoPlay();
    }, 900); // CSS transition süresi kadar bekle
    
    console.log(`✅ Yeni aktif: Item ${currentIndex + 1}`);
}

// ÖNCEKİ SLIDE (Prev)
function prevItem() {
    if (isAnimating || isDragging) return;
    
    console.log(`⬅️ Prev: Item ${currentIndex + 1} → Item ${currentIndex}`);
    
    isAnimating = true;
    slider.classList.add('zoom');
    
    // Mevcut item'ı gizle
    items[currentIndex].classList.remove('active');
    
    // Önceki item'ı aktif yap
    currentIndex = (currentIndex - 1 + itemCount) % itemCount;
    items[currentIndex].classList.add('active');
    
    setTimeout(() => {
        slider.classList.remove('zoom');
        isAnimating = false;
        startAutoPlay();
    }, 900);
    
    console.log(`✅ Yeni aktif: Item ${currentIndex + 1}`);
}

// Next buton event
next.addEventListener('click', (e) => {
    e.preventDefault();
    nextItem();
});

// Prev buton event  
prev.addEventListener('click', (e) => {
    e.preventDefault();
    prevItem();
});

// ============= DRAGABLE (MOBİL + DESKTOP) =============

// TOUCH EVENTS (MOBİL)
slider.addEventListener('touchstart', (e) => {
    startX = e.changedTouches[0].screenX;
    isDragging = true;
    clearInterval(autoPlayInterval); // Sürükleme sırasında autoplay durdur
    console.log(`🖐️ Touch start: X=${startX}`);
}, { passive: true });

slider.addEventListener('touchmove', (e) => {
    if (isDragging) {
        // Opsiyonel: Anlık görsel feedback (hafif kaydırma efekti)
        const currentX = e.changedTouches[0].screenX;
        const deltaX = currentX - startX;
        const translateX = Math.max(-50, Math.min(50, deltaX)); // Maksimum 50px kaydırma
        slider.style.transform = `translateX(${translateX}px)`;
    }
}, { passive: true });

slider.addEventListener('touchend', (e) => {
    if (!isDragging) return;
    
    endX = e.changedTouches[0].screenX;
    const deltaX = endX - startX;
    const absDelta = Math.abs(deltaX);
    
    console.log(`🖐️ Touch end: DeltaX=${deltaX}px (threshold: ${dragThreshold}px)`);
    
    // Geri normal pozisyona dön
    slider.style.transform = 'translateX(0)';
    
    if (absDelta > dragThreshold) {
        if (deltaX > 0) {
            // SAĞA SÜRÜKLEME → ÖNCEKİ SLIDE
            prevItem();
        } else {
            // SOLA SÜRÜKLEME → SONRAKİ SLIDE
            nextItem();
        }
    }
    
    isDragging = false;
    startAutoPlay(); // Sürükleme bitince autoplay devam
}, { passive: true });

// MOUSE EVENTS (DESKTOP)
slider.addEventListener('mousedown', (e) => {
    startX = e.screenX;
    isDragging = true;
    clearInterval(autoPlayInterval);
    console.log(`🖱️ Mouse down: X=${startX}`);
    
    // Seçimi engelle
    e.preventDefault();
});

slider.addEventListener('mousemove', (e) => {
    if (isDragging) {
        const currentX = e.screenX;
        const deltaX = currentX - startX;
        const translateX = Math.max(-50, Math.min(50, deltaX));
        slider.style.transform = `translateX(${translateX}px)`;
    }
});

slider.addEventListener('mouseup', (e) => {
    if (!isDragging) return;
    
    endX = e.screenX;
    const deltaX = endX - startX;
    const absDelta = Math.abs(deltaX);
    
    console.log(`🖱️ Mouse up: DeltaX=${deltaX}px (threshold: ${dragThreshold}px)`);
    
    // Geri normal pozisyona dön
    slider.style.transform = 'translateX(0)';
    
    if (absDelta > dragThreshold) {
        if (deltaX > 0) {
            // SAĞA SÜRÜKLEME → ÖNCEKİ SLIDE
            prevItem();
        } else {
            // SOLA SÜRÜKLEME → SONRAKİ SLIDE
            nextItem();
        }
    }
    
    isDragging = false;
    startAutoPlay();
});

slider.addEventListener('mouseleave', () => {
    if (isDragging) {
        slider.style.transform = 'translateX(0)';
        isDragging = false;
        startAutoPlay();
    }
});

// Mouse hover ile duraklat (ekstra)
slider.addEventListener('mouseenter', () => {
    clearInterval(autoPlayInterval);
});
slider.addEventListener('mouseleave', () => {
    if (!isDragging) {
        startAutoPlay();
    }
});

// Yeniden hesaplama (item sayısı değişirse)
function recomputeSlider() {
    items = document.querySelectorAll('.item');
    itemCount = items.length;
    console.log(`🔄 Slider güncellendi: ${itemCount} item`);
    
    // Mevcut index'i koru
    items.forEach((item, index) => {
        item.classList.toggle('active', index === currentIndex);
    });
    startAutoPlay();
}
        const filterItems = document.querySelectorAll(".filter-item");
        const workers = document.querySelectorAll(".worker-wrapper");
        const sidebarSearch = document.getElementById("sidebarSearch");
        const contentSearch = document.getElementById("contentSearch");

        sidebarSearch.addEventListener("input", () => {
            const term = sidebarSearch.value.toLowerCase();
            filterItems.forEach(item => {
                const text = item.innerText.toLowerCase();
                item.style.display = text.includes(term) ? "block" : "none";
            });
        });

        function applyFilters() {
            const activeFilters = Array.from(filterItems)
                .filter(f => f.classList.contains("active"))
                .map(f => f.dataset.value.toLowerCase());
            const searchText = contentSearch.value.toLowerCase();

            workers.forEach(worker => {
                const category = worker.dataset.category.toLowerCase();
                const text = worker.innerText.toLowerCase();
                const matchesFilter = activeFilters.length === 0 || activeFilters.includes(category);
                const matchesSearch = searchText.length === 0 || text.includes(searchText);

                if (matchesFilter && matchesSearch) {
                    worker.classList.remove("fade-out");
                    worker.classList.add("fade-in");
                } else {
                    worker.classList.remove("fade-in");
                    worker.classList.add("fade-out");
                }
            });
        }

        filterItems.forEach(item => {
            item.addEventListener("click", () => {
                item.classList.toggle("active");
                applyFilters();
            });
        });

        contentSearch.addEventListener("input", applyFilters);
    </script>

</body>

</html>
