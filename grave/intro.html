<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <title>Tarih Animasyonu</title>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            background: black;
            color: white;
            font-family: Arial, sans-serif;
        }

        #year {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(1);
            z-index: 2;
            text-align: center;
            font-size: clamp(2rem, 10vw, 6rem);
            font-weight: bold;
            white-space: nowrap;
            transition: transform 0.1s linear, font-size 0.1s linear;
        }

        .bg {
            position: fixed;
            filter: brightness(0.5);
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 2s ease-in-out;
            z-index: 1;
        }

        .bg.show {
            opacity: 1;
        }
    </style>
</head>

<body>
    <div id="year">0</div>
    <div id="bg1" class="bg"></div>
    <div id="bg2" class="bg"></div>

    <script>
        const currentYear = new Date().getFullYear();
        const yearEl = document.getElementById("year");

        const leaders = [
            { name: "Büyük İskender", img: "images/alexander.jpg" },
            { name: "Cengiz Han", img: "images/genghis.jpg" },
            { name: "Napolyon", img: "images/napoleon.jpg" },
            { name: "Fatih Sultan Mehmet", img: "images/fatih.jpg" },
            { img: "images/img1.png" },
            { img: "images/img2.jpg" },
            { img: "images/img3.jpg" },
            { img: "images/img4.png" },
            { img: "images/img5.jpg" },
            { img: "images/img6.jpg" },
            { img: "images/img7.jpg" },
            { img: "images/img8.jpg" },
            { img: "images/img9.jpg" },
            { img: "images/img10.png" },
            { img: "images/img11.jpg" },
            { img: "images/img12.jpg" },
            { img: "images/img13.jpg" },
            { img: "images/img14.jpg" },
            { img: "images/img15.jpg" },
            { img: "images/img16.jpg" },
            { img: "images/img17.jpg" },
            { img: "images/img18.jpg" },
            { img: "images/img19.jpg" },
            { img: "images/img20.jpg" }
        ];

        const lastImages = [
            { year: currentYear - 2, img: "images/cengiz2.jpg" },
            { year: currentYear - 1, img: "images/Fatih-Sultan-Mehmet-800x315.jpg" },
            { year: currentYear, img: "images/3dduvarkagitlari-1c90ebc2.jpg" }
        ];

        let activeBg = 1;
        const bg1 = document.getElementById("bg1");
        const bg2 = document.getElementById("bg2");

        // Preload
        leaders.concat(lastImages).forEach(item => { new Image().src = item.img; });

        function changeBackground(imgUrl) {
            const nextBg = activeBg === 1 ? bg2 : bg1;
            const prevBg = activeBg === 1 ? bg1 : bg2;

            nextBg.style.backgroundImage = `url(${imgUrl})`;
            nextBg.classList.add("show");
            prevBg.classList.remove("show");

            activeBg = activeBg === 1 ? 2 : 1;
        }

        function getRandomLeaderImage() {
            return leaders[Math.floor(Math.random() * leaders.length)].img;
        }

        function animateYears() {
            return new Promise(resolve => {
                const fastEnd = currentYear - 3;
                const fastDuration = 3000; // 3 saniyede hızlı geçiş
                const startTime = performance.now();

                function fastAnimate(now) {
                    const progress = (now - startTime) / fastDuration;
                    let year = Math.floor(progress * fastEnd);
                    if (year > fastEnd) year = fastEnd;

                    yearEl.textContent = year;
                    yearEl.style.transform = "translate(-50%, -50%) scale(1)";

                    if (year % 10 === 0 && year !== 0) changeBackground(getRandomLeaderImage());

                    if (year < fastEnd) requestAnimationFrame(fastAnimate);
                    else animateLastYears(); // Son 3 yıl animasyonu
                }

                function animateLastYears() {
                    let startScale = 1;
                    let endScale = 6;
                    let startOpacity = 1;
                    let endOpacity = 0.3;
                    let duration = 3000; // 3 saniye boyunca büyüme ve opacity
                    let startTime = performance.now();

                    function scaleAnimate(now) {
                        let t = (now - startTime) / duration;
                        if (t > 1) t = 1;

                        // Ölçekleme
                        let scale = startScale + t * (endScale - startScale);
                        yearEl.style.transform = `translate(-50%, -50%) scale(${scale})`;

                        // Opacity değişimi
                        let opacity = startOpacity + t * (endOpacity - startOpacity);
                        yearEl.style.opacity = opacity;

                        // Yıl değişimi
                        let currentIdx = Math.floor(t * lastImages.length);
                        if (currentIdx >= lastImages.length) currentIdx = lastImages.length - 1;
                        yearEl.textContent = lastImages[currentIdx].year;
                        changeBackground(lastImages[currentIdx].img);

                        if (t < 1) requestAnimationFrame(scaleAnimate);
                        else yearEl.style.opacity = 1; // tam görünürlük
                    }

                    requestAnimationFrame(scaleAnimate);
                }


                requestAnimationFrame(fastAnimate);
            });
        }

        // Başlat
        changeBackground(getRandomLeaderImage());
        animateYears().then(() => console.log("Animasyon tamamlandı!"));
    </script>
</body>

</html>